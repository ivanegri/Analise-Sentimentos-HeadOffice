services:
  # API de Sentimentos (porta 5000)
  sentiment-api:
    build: .
    container_name: sentiment_api
    restart: always
    ports:
      - "5000:5000"
    command: gunicorn -w 1 -b 0.0.0.0:5000 app:app --timeout 300
    environment:
      - WORKERS=1
    deploy:
      resources:
        limits:
          memory: 4G

  # Dashboard Web (porta 5001)
  sentiment-dashboard:
    build: .
    container_name: sentiment_dashboard
    restart: always
    ports:
      - "5001:5001"
    command: gunicorn -w 1 -b 0.0.0.0:5001 app_dashboard:app --timeout 300
    volumes:
      - dashboard_sessions:/app/sessions
      - dashboard_feedbacks:/app/data
    environment:
      - WORKERS=1
      - DATA_DIR=/app/data
    deploy:
      resources:
        limits:
          memory: 4G

volumes:
  dashboard_sessions:
  dashboard_feedbacks:
